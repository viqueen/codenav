#!/usr/bin/env node

const program = require('commander');
const CodeNavConfig = require('../lib/codenav-config');
const CodeNavStore = require('../lib/codenav-store');

const codeNavConfig = new CodeNavConfig();
const codeNavStore = new CodeNavStore(codeNavConfig);

program.command('register <sshUrlConnection>')
    .description('registers a new repo using its ssh url connection')
    .action((sshUrlConnection) => {
        codeNavStore.register(sshUrlConnection);
    });

program.command('list')
    .description('lists registered repos')
    .action(() => {
        codeNavStore.list();
    });

// configuration handlers

program.command('config')
    .description('displays cnav configuration')
    .action(() => {
        console.log(codeNavConfig.config());
    });

program.command('set-config <key> <value>')
    .description('updates cnav configuration entry')
    .action((key, value) => {
        codeNavConfig.set(key, value);
    });

program.command('get-config <key>')
    .description('gets cnav configuration entry')
    .action((key) => {
        console.log(codeNavConfig.get(key));
    });

program.version('1.0.0');
program.parse(process.argv);